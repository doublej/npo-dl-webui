<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPO Downloader</title>
    <link rel="stylesheet" href="npo-base.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="theme-npo.css">
    <link rel="icon" href="/favicon.ico" sizes="any">
</head>
<body>
    <div class="container">
        <header class="topbar" role="banner">
            <div class="topbar__inner">
                <a href="#" class="brand" aria-label="NPO home">
                    <svg class="brand__logo" xmlns="http://www.w3.org/2000/svg" width="78" height="52" viewBox="0 0 78 52" fill="none" aria-hidden="true">
                        <path d="M50.6002 29.3366L29.4477 50.4081C27.3186 52.5305 24.8756 52.5305 22.7478 50.4081L1.59776 29.3378C-0.532587 27.2161 -0.532587 24.7841 1.59776 22.6624L22.7484 1.59273C24.8788 -0.53091 27.3192 -0.53091 29.4477 1.59273L50.5989 22.6624C52.7293 24.7822 52.7293 27.2155 50.6002 29.3366Z" fill="rgba(var(--logo-npo-gray))"></path>
                        <path d="M22.1726 15.0946L20.5652 13.5002C18.9736 11.9126 17.0605 11.8831 15.2744 13.665L14.0011 14.9335C12.2137 16.7124 12.2415 18.617 13.8338 20.2065L18.9831 25.334C19.5781 25.9236 20.2475 25.8368 20.7042 25.3825C21.1615 24.9269 21.2385 24.2719 20.6454 23.6785L19.4606 22.5013C19.7827 22.4333 20.1793 22.1885 20.6461 21.7248L22.0046 20.3688C23.7945 18.5894 23.7636 16.6847 22.1726 15.0946ZM7.08523 21.8217C8.87389 20.041 10.7851 20.0699 12.3786 21.6581L15.7892 25.0534C16.3828 25.6461 16.2951 26.3106 15.8372 26.7674C15.3805 27.2217 14.7186 27.301 14.1268 26.7076L10.7472 23.3419C10.1074 22.7013 9.50295 22.7221 8.78547 23.4394L7.43513 24.7841C6.71512 25.4995 6.69554 26.1004 7.33597 26.7372L10.715 30.1073C11.3106 30.6957 11.2316 31.3557 10.7762 31.8132C10.3183 32.2656 9.65138 32.3543 9.05516 31.7622L5.6471 28.3631C4.05297 26.7756 4.02455 24.8684 5.81195 23.0877L7.08523 21.8217ZM23.3177 5.6512C25.1038 3.86986 27.0194 3.89818 28.6098 5.48634L30.2153 7.08206C31.8075 8.67023 31.8359 10.5768 30.0473 12.3569L28.7759 13.6266C26.9898 15.4067 25.0748 15.379 23.4832 13.7877L21.8777 12.1926C20.2873 10.6051 20.2576 8.6998 22.0463 6.91972L23.3177 5.6512ZM26.9809 7.16889C26.338 6.53023 25.736 6.54911 25.0179 7.26705L23.667 8.61234C22.9495 9.32714 22.9286 9.92868 23.5716 10.5655L25.1146 12.1052C25.7563 12.7457 26.3569 12.7262 27.0775 12.0083L28.4279 10.6624C29.1441 9.94819 29.1649 9.34539 28.5245 8.70924L26.9809 7.16889ZM20.4812 16.7231C21.1217 17.3605 21.1014 17.9626 20.3827 18.6762L19.033 20.0221C18.3117 20.7388 17.7136 20.7583 17.0713 20.1184L15.5264 18.578C14.8854 17.9419 14.9037 17.3403 15.6218 16.6255L16.9709 15.2796C17.6928 14.5623 18.294 14.5447 18.9364 15.1827L20.4812 16.7231Z" fill="rgba(var(--orange-500))"></path>
                        <path d="M26.7531 22.6618C24.624 24.7829 24.624 27.2155 26.7531 29.3366L47.9044 50.4081C50.0348 52.5305 52.4753 52.5305 54.6063 50.4081L75.757 29.3366C77.8861 27.2155 77.8842 24.7817 75.757 22.6618L54.6063 1.59225C52.4753 -0.530751 50.0348 -0.530751 47.9063 1.59225L26.7531 22.6618Z" fill="rgba(var(--orange-500))" fill-rule="evenodd" clip-rule="evenodd"></path>
                        <path d="M38.0479 25.0108C37.0558 24.7751 36.7428 24.6796 36.7428 24.2497C36.7428 23.657 37.5824 23.5684 38.0832 23.5684C38.5417 23.5684 39.1174 23.6746 39.6232 23.8525C39.753 23.8959 39.8808 23.9342 40.0106 23.9342C40.369 23.9342 40.5347 23.6608 40.6499 23.3924L40.728 23.2058C40.7709 23.0901 40.8118 22.9644 40.8118 22.8305C40.8118 22.5351 40.6228 22.2963 40.2947 22.1763C39.5098 21.8796 38.6834 21.8174 38.1285 21.8174C35.9479 21.8174 34.6976 22.7432 34.6976 24.3566C34.6976 26.1509 36.1885 26.4822 37.7682 26.8322L37.7953 26.8379C38.6677 27.0315 39.0878 27.1459 39.0878 27.6235C39.0878 27.7951 39.0878 28.3199 37.6397 28.3199C37.0602 28.3199 36.4568 28.2074 35.7935 27.9742C35.6632 27.9315 35.5359 27.8925 35.4062 27.8925C35.0484 27.8925 34.8821 28.1659 34.7675 28.4337L34.6736 28.6524C34.6302 28.7681 34.5898 28.8931 34.5898 29.0276C34.5898 29.323 34.7782 29.5612 35.1045 29.6813C35.7589 29.9402 36.6067 30.071 37.624 30.071C39.8865 30.071 41.133 29.1634 41.133 27.5161C41.133 25.7229 39.6339 25.3773 38.0479 25.0108ZM55.3929 25.3703L50.1744 22.0977C49.7366 21.8237 49.1678 22.1373 49.1678 22.6527V29.1967C49.1678 29.7121 49.7366 30.0257 50.1744 29.7517L55.3929 26.4797C55.803 26.2226 55.803 25.6268 55.3929 25.3703ZM47.7739 28.6989C47.7033 28.3677 47.5276 28.2131 47.2196 28.2131C47.1484 28.2131 47.0035 28.2294 46.9154 28.2445C46.7573 28.264 46.6231 28.274 46.5166 28.274C45.7167 28.274 45.2216 28.0245 45.2216 26.7832V23.7513H47.0061C47.5415 23.7513 47.7909 23.5024 47.7909 22.9682V22.7539C47.7909 22.219 47.5415 21.9701 47.0061 21.9701H45.2216V20.8306C45.2216 20.2958 44.9715 20.0469 44.4355 20.0469H43.9467C43.4107 20.0469 43.1606 20.2958 43.1606 20.8306V21.9701H42.7071C42.1711 21.9701 41.9217 22.219 41.9217 22.7539V22.9682C41.9217 23.5024 42.1711 23.7513 42.7071 23.7513H43.1606V26.9668C43.1606 29.0553 44.1678 30.071 46.2408 30.071C46.6363 30.071 47.0067 30.0125 47.2857 29.9622C47.6712 29.8925 47.8829 29.6637 47.8829 29.3174C47.8829 29.2407 47.8602 29.115 47.835 28.9893L47.7739 28.6989ZM68.5014 28.9893L68.4396 28.6989C68.3697 28.3677 68.194 28.2131 67.886 28.2131C67.8142 28.2131 67.6699 28.2294 67.5817 28.2445C67.4236 28.264 67.2895 28.274 67.1824 28.274C66.3831 28.274 65.8874 28.0245 65.8874 26.7832V23.7513H67.6718C68.2079 23.7513 68.4573 23.5024 68.4573 22.9682V22.7539C68.4573 22.219 68.2079 21.9701 67.6718 21.9701H65.8874V20.8306C65.8874 20.2958 65.6379 20.0469 65.1019 20.0469H64.6125C64.0765 20.0469 63.8264 20.2958 63.8264 20.8306V21.9701H63.3735C62.8375 21.9701 62.5874 22.219 62.5874 22.7539V22.9682C62.5874 23.5024 62.8375 23.7513 63.3735 23.7513H63.8264V26.9668C63.8264 29.0553 64.8342 30.071 66.9065 30.071C67.3027 30.071 67.6731 30.0125 67.9521 29.9622C68.337 29.8925 68.5492 29.6637 68.5492 29.3174C68.5492 29.2407 68.5259 29.1156 68.5014 28.9893ZM61.7113 22.571C61.7113 22.6432 61.6943 22.8035 61.6785 22.8827L61.6476 23.0354C61.5525 23.4798 61.4095 23.7362 60.9567 23.7362C60.8628 23.7362 60.7419 23.7255 60.6027 23.7136C60.4131 23.6966 60.1775 23.6753 59.9318 23.6753C59.5917 23.6753 59.1269 23.7136 58.805 23.7997V29.1345C58.805 29.6693 58.5549 29.9182 58.0195 29.9182H57.5301C56.9941 29.9182 56.744 29.6693 56.744 29.1345V23.1052C56.744 22.5948 56.9746 22.2938 57.4696 22.1574C58.2457 21.9387 59.1143 21.8174 59.9161 21.8174C60.3268 21.8174 60.7022 21.8388 61.0316 21.8796C61.4637 21.9311 61.7113 22.1832 61.7113 22.571Z" fill="white" fill-rule="evenodd" clip-rule="evenodd"></path>
                    </svg>
                    <span class="brand__title">Downloader</span>
                </a>
                <nav class="primary-nav" aria-label="Hoofdnavigatie">
                    <button class="tab-button active" data-tab="episode">Single Episode</button>
                    <button class="tab-button" data-tab="show">Entire Show</button>
                    <button class="tab-button" data-tab="season">Season</button>
                    <button class="tab-button" data-tab="batch">Batch Download</button>
                    <button class="tab-button" data-tab="downloads">Downloads</button>
                    <button class="tab-button" data-tab="settings">Settings</button>
                </nav>
                <div id="topbar-status" class="topbar__status" aria-live="polite"></div>
            </div>
        </header>

        <main>
            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Single Episode Tab -->
                <div id="episode-tab" class="tab-pane active">
                    <form id="episode-form">
                            <label for="episode-url">episode url:</label>
                        <div class="form-group">
                            <input
                                type="url"
                                id="episode-url"
                                placeholder="https://npo.nl/start/serie/..."
                                required
                            >
                        </div>
                        <button type="submit" class="btn-primary">Download Episode</button>
                    </form>
                </div>

                <!-- Entire Show Tab -->
                <div id="show-tab" class="tab-pane">
                    <form id="show-form">
                            <label for="show-url">show url:</label>
                        <div class="form-group">
                            <input
                                type="url"
                                id="show-url"
                                placeholder="https://npo.nl/start/serie/..."
                                required
                            >
                        </div>
                            <label for="season-count">number of seasons (optional):</label>
                        <div class="form-group">
                            <input
                                type="number"
                                id="season-count"
                                min="1"
                                placeholder="All seasons"
                            >
                        </div>
                        <div class="form-group">
                            <label>
                                start from first season
                            </label>
                                <input type="checkbox" id="show-reverse">
                        </div>
                        <button type="submit" class="btn-primary">Download Show</button>
                    </form>
                </div>

                <!-- Season Tab -->
                <div id="season-tab" class="tab-pane">
                    <form id="season-form">
                            <label for="season-url">season url:</label>
                        <div class="form-group">
                            <input
                                type="url"
                                id="season-url"
                                placeholder="https://npo.nl/start/serie/.../seizoen-..."
                                required
                            >
                        </div>
                        <div class="form-group">
                            <label>
                                start from first episode
                            </label>
                                <input type="checkbox" id="season-reverse">
                        </div>
                        <button type="submit" class="btn-primary">Download Season</button>
                    </form>
                </div>

                <!-- Batch Download Tab -->
                <div id="batch-tab" class="tab-pane">
                    <form id="batch-form">
                            <label for="batch-urls">episode urls (one per line):</label>
                        <div class="form-group">
                            <textarea
                                id="batch-urls"
                                rows="10"
                                placeholder="https://npo.nl/start/serie/...
https://npo.nl/start/serie/...
https://npo.nl/start/serie/..."
                                required
                            ></textarea>
                        </div>
                        <button type="submit" class="btn-primary">Download All</button>
                    </form>
                </div>

                <!-- Settings Tab -->
                <div id="settings-tab" class="tab-pane">
                    <form id="settings-form">
                        <h3>NPO Credentials</h3>
                            <label for="npo-email">npo email:</label>
                        <div class="form-group">
                            <input
                                type="email"
                                id="npo-email"
                                placeholder="your-email@example.com"
                                required
                            >
                        </div>
                            <label for="npo-password">npo password:</label>
                        <div class="form-group">
                            <input
                                type="password"
                                id="npo-password"
                                placeholder="Your NPO password"
                                required
                            >
                            <small class="help-text">Password is stored locally in .env file</small>
                        </div>

                        <h3 style="margin-top: 30px;">NPO Profile</h3>
                            <label for="npo-profile">selected profile:</label>
                        <div class="form-group">
                            <div id="profile-selection" style="display: flex; gap: 10px; align-items: center;">
                                <span id="current-profile" style="font-weight: bold;">Not selected</span>
                                <button type="button" id="select-profile" class="btn-secondary">Select Profile</button>
                            </div>
                            <div id="profile-list" style="display: none; margin-top: 10px;">
                                <small class="help-text">Available profiles:</small>
                                <div id="profile-buttons" style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;"></div>
                            </div>
                        </div>

                        <h3 style="margin-top: 30px;">API Configuration</h3>
                            <label for="api-key">getwvkeys api key:</label>
                        <div class="form-group">
                            <input
                                type="password"
                                id="api-key"
                                placeholder="Your API key from getwvkeys.cc"
                                required
                            >
                            <small class="help-text">Get your key from <a href="https://getwvkeys.cc/me" target="_blank">getwvkeys.cc/me</a></small>
                        </div>

                        <h3 style="margin-top: 30px;">Browser Settings</h3>
                        <div class="form-group">
                            <label>
                                run in headless mode (window)
                            </label>
                                <input type="checkbox" id="headless-mode">
                            <small class="help-text">Enable for background downloads, disable for debugging</small>
                        </div>

                        <div class="button-group">
                            <button type="submit" class="btn-primary">Save Settings</button>
                            <button type="button" id="test-connection" class="btn-secondary">Test Connection</button>
                        </div>


                    </form>
                </div>

                <!-- Downloads Tab -->
                <div id="downloads-tab" class="tab-pane">
                    <div class="downloads-layout">
                        <!-- Navigation breadcrumb -->
                        <div id="downloads-breadcrumb" class="breadcrumb">
                            <span class="breadcrumb-item active" data-level="shows">Shows</span>
                        </div>

                        <div class="downloads-content">
                            <!-- Left panel: Shows/Seasons/Episodes list -->
                            <div class="downloads-list-panel">
                                <h3 id="downloads-list-title">Downloaded Shows</h3>
                                <div id="downloaded-container">
                                    <p class="no-downloads">Loading...</p>
                                </div>
                            </div>

                            <!-- Right panel: Episode details and player -->
                            <div class="downloads-detail-panel">
                                <div id="episode-details" style="display: none;">
                                    <h3 id="episode-title"></h3>
                                    <div class="episode-metadata">
                                        <div class="metadata-item">
                                            <strong>Episode:</strong> <span id="episode-number"></span>
                                        </div>
                                        <div class="metadata-item">
                                            <strong>Aired:</strong> <span id="episode-airing"></span>
                                        </div>
                                        <div class="metadata-item">
                                            <strong>Duration:</strong> <span id="episode-duration"></span>
                                        </div>
                                        <div class="metadata-item">
                                            <strong>File Size:</strong> <span id="episode-size"></span>
                                        </div>
                                        <div class="metadata-description">
                                            <strong>Description:</strong>
                                            <p id="episode-description"></p>
                                        </div>
                                    </div>
                                    <button id="play-episode" class="btn-primary" style="margin-top: 1rem;">Play Episode</button>
                                </div>

                                <div id="player-section" style="margin-top: 1rem; display: none;">
                                    <video id="video-player" controls style="width:100%; max-width: 100%; background:#000; border-radius: 8px;" crossorigin="anonymous"></video>
                                    <div id="now-playing" class="help-text" style="margin-top: 8px;"></div>
                                </div>

                                <div id="no-selection" class="no-selection-message">
                                    <p>Select an episode to view details</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            footer
        </footer>
    </div>

    <!-- Download Overlay -->
    <div id="download-overlay" class="download-overlay" style="display: none;"></div>

    <!-- Profile Selection Modal -->
    <div id="profile-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Select NPO Profile</h2>
            <p>Please select a profile to continue with the download:</p>
            <div id="modal-profile-buttons" class="profile-grid"></div>
            <button id="modal-cancel" class="btn-secondary" style="margin-top: 20px;">Cancel</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
